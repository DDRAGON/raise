function sendImage(e){"ng"==e&&(e="nextGame"),"rg"==e&&(e="resetGame"),socket.emit("imageSendWithPassWord",{image:e,passWord:$("#inputArea").val()})}function sound(){var e=$("[name=musicFileName] option:selected").text();"アニキランダム"==e&&(e=anikiMusicFileName[Math.floor(Math.random()*anikiMusicFileName.length)]);var e=e.replace(".","\\.");$("#"+e).get(0).play()}function RewriteAndRead(){config.ctxForVideo.drawImage(video,0,0,config.canvasWidth,config.canvasHeight);var e=config.ctxForVideo.getImageData(0,0,config.canvasWidth,config.canvasHeight);lastCardPassedTimeSec+=.001*readQRCodeIntervalTimeMSec,lastCardPassedTimeSec>=1&&(lastCardPassedTimeSec=0,setLastCard(""),lastCard="");try{var a=new com.google.zxing.qrcode.QRCodeReader,t=new RGBLuminanceSource(e.data,e.width,e.height),n=new com.google.zxing.BinaryBitmap(new com.google.zxing.common.HybridBinarizer(t)),i=a.decode1(n),o=i.get_text();""===lastCard||lastCard!==o?(setLastCard(o),lastCardPassedTimeSec=0,sound(),sendImage(o)):lastCard===o&&(lastCardPassedTimeSec=0)}catch(s){}setTimeout("RewriteAndRead()",readQRCodeIntervalTimeMSec)}function setLastCard(e){lastCard=e,$("#result").html(e)}function setColorAndFont(e,a){config.ctx.fillStyle=e,config.ctx.font="bold "+a+"px 'ITC HIGHLANDER'"}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia,window.URL=window.URL||window.webkitURL;var video=document.getElementById("myVideo"),localStream=null;navigator.getUserMedia({video:!0,audio:!1},function(e){video.src=window.URL.createObjectURL(e)},function(e){console.log(e)});var socket=io.connect("http://"+hostAddress+"/qrCodeReader"),config={canvasWidth:400,canvasHeight:300},lastCard="",lastCardPassedTimeSec=0,readQRCodeIntervalTimeMSec=50,anikiMusicFileName=["aniki1.wav","aniki2.mp3","aniki3.wav","aniki4.wav","aniki5.wav"];$(function(){var e=$("#canvasForVideo").get(0);config.ctxForVideo=e.getContext("2d"),RewriteAndRead()}),$("#changeReadQRCodeIntervalTimeMSec").change(function(){switch($(this).val()){case"標準":return readQRCodeIntervalTimeMSec=100,void 0;case"高速":return readQRCodeIntervalTimeMSec=50,void 0}});