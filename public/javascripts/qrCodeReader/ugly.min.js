function sendImage(e){"ng"==e&&(e="nextGame"),"rg"==e&&(e="resetGame"),socket.emit("imageSendWithPassWord",{image:e,passWord:$("#inputArea").val()})}function sound(){$("#sound-file").get(0).play()}function RewriteAndRead(){config.ctxForVideo.drawImage(video,0,0,config.canvasWidth,config.canvasHeight);var e=config.ctxForVideo.getImageData(0,0,config.canvasWidth,config.canvasHeight);lastCardPassedTimeSec+=.001*readQRCodeIntervalTimeMSec,lastCardPassedTimeSec>=1&&(lastCardPassedTimeSec=0,setLastCard(""),lastCard="");try{var n=new com.google.zxing.qrcode.QRCodeReader,a=new RGBLuminanceSource(e.data,e.width,e.height),i=new com.google.zxing.BinaryBitmap(new com.google.zxing.common.HybridBinarizer(a)),o=n.decode1(i),t=o.get_text();""===lastCard||lastCard!==t?(setLastCard(t),lastCardPassedTimeSec=0,sound(),sendImage(t)):lastCard===t&&(lastCardPassedTimeSec=0)}catch(r){}setTimeout("RewriteAndRead()",readQRCodeIntervalTimeMSec)}function setLastCard(e){lastCard=e,$("#result").html(e)}function setColorAndFont(e,n){config.ctx.fillStyle=e,config.ctx.font="bold "+n+"px 'ITC HIGHLANDER'"}navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia,window.URL=window.URL||window.webkitURL;var video=document.getElementById("myVideo"),localStream=null;navigator.getUserMedia({video:!0,audio:!1},function(e){video.src=window.URL.createObjectURL(e)},function(e){console.log(e)});var socket=io.connect("http://"+hostAddress+"/qrCodeReader"),config={canvasWidth:400,canvasHeight:300},lastCard="",lastCardPassedTimeSec=0,readQRCodeIntervalTimeMSec=50;$(function(){var e=$("#canvasForVideo").get(0);config.ctxForVideo=e.getContext("2d"),RewriteAndRead()}),$("#changeReadQRCodeIntervalTimeMSec").change(function(){switch($(this).val()){case"標準":return readQRCodeIntervalTimeMSec=100,void 0;case"高速":return readQRCodeIntervalTimeMSec=50,void 0}});