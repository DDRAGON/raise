function markClick(t){this.mark=t,drawImage()}function numClick(t){this.num=t,drawImage()}function sendImage(t){if(socket.emit("imageSend",t),sound(),$("#message").html("send "+t),this.mark="",this.num="　",drawImage(),drawSentImage(t),"start"==t)for(var i=0;10>i;i++)$("#inputPlayer"+i).val("")}function sendCard(){return"s"!=this.mark&&"h"!=this.mark&&"d"!=this.mark&&"c"!=this.mark?($("#message").html("mark is invalid!"),void 0):"2"!=this.num&&"3"!=this.num&&"4"!=this.num&&"5"!=this.num&&"6"!=this.num&&"7"!=this.num&&"8"!=this.num&&"9"!=this.num&&"T"!=this.num&&"J"!=this.num&&"Q"!=this.num&&"K"!=this.num&&"A"!=this.num?($("#message").html("number is invalid!"),void 0):(sendImage(this.num+this.mark),void 0)}function drawImage(){switch(this.mark){case"s":$("#image").html('<span style="color:#000000;font-size:64px;">'+this.num+"♠</span>");break;case"h":$("#image").html('<span style="color:#ff0000;font-size:64px;">'+this.num+"♥</span>");break;case"d":$("#image").html('<span style="color:#0000ff;font-size:64px;">'+this.num+"♦</span>");break;case"c":$("#image").html('<span style="color:#00bb00;font-size:64px;">'+this.num+"♣</span>");break;default:$("#image").html('<span style="color:#000000;font-size:64px;">'+this.num+"</span>")}}function drawSentImage(t){switch(t[1]){case"s":$("#sentImage").html('<span style="color:#000000;font-size:64px;">'+t[0]+"♠</span>");break;case"h":$("#sentImage").html('<span style="color:#ff0000;font-size:64px;">'+t[0]+"♥</span>");break;case"d":$("#sentImage").html('<span style="color:#0000ff;font-size:64px;">'+t[0]+"♦</span>");break;case"c":$("#sentImage").html('<span style="color:#00bb00;font-size:64px;">'+t[0]+"♣</span>");break;default:$("#sentImage").html('<span style="color:#000000;font-size:64px;">'+t[0]+"</span>")}}function keyDown(){var t=$("#inputArea").val().toUpperCase()+String.fromCharCode(event.keyCode).toLowerCase();if(1==easyMode){var i=cardsForEasyMode.indexOf(t);if(i>=0)return sendImage(cards[i]),setTimeout(function(){$("#inputArea").val("")},100),void 0;"g"==t&&(sound(),setTimeout(function(){$("#inputArea").val("")},100))}else cards.indexOf(t)>=0&&(sendImage(t),setTimeout(function(){$("#inputArea").val("")},100))}function keyUpPlayer(t){var i=$("#inputPlayer"+t).val();socket.emit("updatePlayerName",{seatId:t,name:i})}function deletePlayer(t){$("#inputPlayer"+t).val(""),socket.emit("updatePlayerName",{seatId:t,name:""})}function moveDealerButton(){socket.emit("moveDealerButton",{})}function sound(){var t="";t+="<EMBED id = 'id_sound'",t+=" SRC=/music/cursor6.wav",t+=" AUTOSTART='true'",t+=" HIDDEN='true'>",document.getElementById("id_sound").innerHTML=t}function drawBackGround(){setColorAndFont("yellow",0),config.ctx.fillRect(0,0,config.canvasWidth,config.canvasHeight)}function drawBox(t){var i=Math.floor(t/5)*(config.canvasWidth-config.boxWidth),n=Math.floor(t%5)*config.displayHeight+config.displayCardHeight,a=Math.floor(config.boxHeight/2);setColorAndFont("black",0),config.ctx.fillRect(i,n,config.boxWidth,a),setColorAndFont("white",0),n+=a,config.ctx.fillRect(i,n,config.boxWidth,a)}function drawDealerButton(t){var i=Math.floor(config.boxHeight/2),n=Math.floor(t/5)*(config.canvasWidth-config.boxWidth),a=Math.floor(t%5)*config.displayHeight+config.displayCardHeight+i;5>t?n+=config.boxWidth+i:n-=i,setColorAndFont("white",0),config.ctx.beginPath(),config.ctx.arc(n,a,i,0,2*Math.PI,!1),config.ctx.fill(),setColorAndFont("green",config.fontSize+5),n-=i/2,a+=i/2,config.ctx.fillText("D",n,a)}function drawPlayerHands(t,i){var n=Math.floor(t/5)*(config.canvasWidth-config.boxWidth),a=Math.floor(t%5)*config.displayHeight;i&&i[0]&&drawCard(i[0],n,a),i&&i[1]&&(n+=config.displayCardWidth,drawCard(i[1],n,a))}function drawPlayerWinperAndName(t,i,n,a){setColorAndFont("white",config.fontSize);var o=Math.floor(t/5)*(config.canvasWidth-config.boxWidth)+3,e=Math.floor(t%5)*config.displayHeight+config.displayCardHeight+config.fontSize-2;return n&&config.ctx.fillText(n,o,e),e+=config.fontSize,void 0!==a?(setColorAndFont("black",config.fontSize),0==a?(config.ctx.fillText("Fold",o,e),void 0):(i&&config.ctx.fillText(i,o,e),void 0)):void 0}function drawBoard(t){setColorAndFont("green",0);var i=Number(config.canvasWidth/2)-Number(config.boardWidth/2),n=config.canvasHeight-config.boardHeight;config.ctx.fillRect(i,n,config.boardWidth,config.boardHeight),i+=config.boardWidthSpace,n+=config.boardHeightSpace;for(var a in t){var o=t[a];drawCard(o,i,n),i+=config.displayCardWidth}}function drawCard(t,i,n){switch(setColorAndFont("white",0),config.ctx.fillRect(i,n,2*config.cardFontSize-11,config.cardFontSize),drawX=i+2,drawY=n+config.cardFontSize-3,t.charAt(1)){case"s":return setColorAndFont("black",config.cardFontSize),config.ctx.fillText(t.charAt(0),drawX,drawY),setColorAndFont("black",config.markFontSize),config.ctx.fillText("♠",drawX+config.markAdjust,drawY),void 0;case"c":return setColorAndFont("green",config.cardFontSize),config.ctx.fillText(t.charAt(0),drawX,drawY),setColorAndFont("green",config.markFontSize),config.ctx.fillText("♣",drawX+config.markAdjust,drawY),void 0;case"d":return setColorAndFont("blue",config.cardFontSize),config.ctx.fillText(t.charAt(0),drawX,drawY),setColorAndFont("blue",config.markFontSize),config.ctx.fillText("♦",drawX+config.markAdjust,drawY),void 0;case"h":return setColorAndFont("red",config.cardFontSize),config.ctx.fillText(t.charAt(0),drawX,drawY),setColorAndFont("red",config.markFontSize),config.ctx.fillText("♥",drawX+config.markAdjust,drawY),void 0}}function setColorAndFont(t,i){config.ctx.fillStyle=t,config.ctx.font="bold "+i+"px 'ITC HIGHLANDER'"}var socket=io.connect("http://"+hostAddress+"/oddsSystem"),easyMode=!1,mark="",num="　",config={canvasWidth:640,canvasHeight:360,originalCardWidth:48,originalCardHeight:64,displayCardWidth:36,displayCardHeight:48,space:8,boardWidthSpace:6,boardHeightSpace:6,cardFontSize:30,markFontSize:30,markAdjust:20};config.displayCardWidth=2*config.cardFontSize-11,config.displayCardHeight=config.cardFontSize,config.displayWidth=2*config.displayCardWidth,config.displayHeight=Number(config.canvasHeight/5),config.boxWidth=config.displayWidth,config.boxHeight=config.displayHeight-config.displayCardHeight-config.space,config.boardWidth=5*config.displayCardWidth+2*config.boardWidthSpace,config.boardHeight=config.cardFontSize+2*config.boardHeightSpace,config.fontSize=Number(config.boxHeight/2);var cards=["As","2s","3s","4s","5s","6s","7s","8s","9s","Ts","Js","Qs","Ks","Ah","2h","3h","4h","5h","6h","7h","8h","9h","Th","Jh","Qh","Kh","Ad","2d","3d","4d","5d","6d","7d","8d","9d","Td","Jd","Qd","Kd","Ac","2c","3c","4c","5c","6c","7c","8c","9c","Tc","Jc","Qc","Kc"],cardsForEasyMode=["Ta","2a","3a","4a","5a","6a","7a","8a","9a","Qa","Wa","Ea","Ra","Ts","2s","3s","4s","5s","6s","7s","8s","9s","Qs","Ws","Es","Rs","Td","2d","3d","4d","5d","6d","7d","8d","9d","Qd","Wd","Ed","Rd","Tf","2f","3f","4f","5f","6f","7f","8f","9f","Qf","Wf","Ef","Rf"];$("#changeInputMode").change(function(){easyMode="easy"==$(this).val()?!0:!1}),$(function(){var t=$("#canvas").get(0);config.ctx=t.getContext("2d")}),socket.on("tableInfo",function(t){var i=t.players,n=t.board;drawBackGround();for(var a in i){var o=i[a];o&&(drawBox(o.seatId),1==o.isActive&&drawPlayerHands(o.seatId,o.hand),drawPlayerWinperAndName(o.seatId,o.win,o.name,o.isActive),n&&n.length>0&&drawBoard(n))}drawDealerButton(t.button)});