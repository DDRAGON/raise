function addUpdateTableInfoListener(a){socket.on("tableInfo",a)}function addUpdatePasswordListener(a){socket.on("passWord",a)}function emitUpdatePlayerName(a,b,c){socket.emit("updatePlayerName",{seatId:a,name:b,passWord:c})}function emitChangeAssistantMode(a){socket.emit("changeAssistantMode",a)}function emitUpdateAssistantPassword(a){socket.emit("updateAssistantPassword",a)}function emitImageSendWithPassWord(a,b){socket.emit("imageSendWithPassWord",{image:a,passWord:b})}function drawTableInfo(a){var b=a.players,c=a.board;displayInit(),displayDealerButton(a.button),displayBoard(c);for(var d in b){var e=b[d];e&&(isActive(e)&&resetPlayerBox(e.seatId),displayName(e.seatId,e.name),displayHand(e.seatId,e.hand,e.isActive),displayOdds(e.seatId,e.win,e.tie),lastTableInfo.players&&lastTableInfo.players[d]&&isActive(lastTableInfo.players[d])&&!isActive(e)&&displayFold(e.seatId))}calculateOddsStyle(),updateInputPlayerNames(b),lastTableInfo=a}function displayInit(){$(".playerBox").hide()}function resetPlayerBox(a){$("#player"+a+"Folded").hide(),$("#player"+a+"Box").css({opacity:"1.0"})}function isActive(a){return 1==a.isActive}function displayDealerButton(a){$(".dealer").removeClass("on"),$("#player"+a+"Dealer").addClass("on")}function displayBoard(a){if(!a||a.length<=0)$(".board").fadeOut(200,function(){$(".board.card").removeClass("color_s color_h color_d color_c mark_s mark_h mark_d mark_c").text("")});else{$("#board").show();for(var b in a){var c=a[b];$selector=$("#board"+b),$selector.fadeIn(),$selector.text(c.charAt(0)),$selector.addClass("color_"+c.charAt(1)),$selector.addClass("mark_"+c.charAt(1))}}}function displayHand(a,b,c){return $leftCard=$("#player"+a+"HandLeft"),$rightCard=$("#player"+a+"HandRight"),c?(b&&b[0]?displayCard($leftCard,b[0]):hideCard($leftCard),void(b&&b[1]?displayCard($rightCard,b[1]):hideCard($rightCard))):(hideCard($leftCard),void hideCard($rightCard))}function hideCard(a){a.hide(),a.removeClass("color_s color_h color_d color_c mark_s mark_h mark_d mark_c").text("")}function displayCard(a,b){a.text(b.charAt(0)),a.addClass("color_"+b.charAt(1)),a.addClass("mark_"+b.charAt(1)),a.fadeIn()}function displayName(a,b){b&&($("#player"+a+"Box").show(),$("#player"+a+"Name").text(b))}function displayFold(a){$("#player"+a+"Folded").show().textillate({"in":{effect:"swing"},callback:function(){$("#player"+a+"Box").stop().animate({opacity:"0.5"},600)}}).textillate("start")}function displayOdds(a,b,c){var d=$("#player"+a+"Odds");if(b){var e=createWinOdds(b),f=createTieOdds(c);f?d.addClass("withTie"):d.removeClass("withTie"),oddsList.push(e),d.attr("data-win",e).text(e+f+"%").show()}else d.hide()}function createWinOdds(a){return roundOdds(a)}function createTieOdds(a){var b=roundOdds(a);return 5>b?"":"("+b+")"}function roundOdds(a){return a?Math.round(10*Number(a.replace("%","")))/10:void 0}function calculateOddsStyle(){var a=$(".odds");a.removeClass("max win");var b=Math.max.apply(null,oddsList);$(".odds[data-win='"+b+"']").addClass("max"),$(".odds[data-win='100']").addClass("win"),oddsList=[]}function updateInputPlayerNames(a){for(var b=0;10>b;b++)if(a[b]){var c=a[b];$("#inputPlayer"+b).val(c.name)}else $("#inputPlayer"+b).val("")}function setPassword(a){$("#room_id").attr("value",a)}function setLayoutSides(){$("#player0Box").css({left:"0px",top:"10px"}),$("#player1Box").css({left:"0px",top:"80px"}),$("#player2Box").css({left:"0px",top:"150px"}),$("#player3Box").css({left:"0px",top:"220px"}),$("#player4Box").css({left:"0px",top:"290px"}),$("#player5Box").css({left:"560px",top:"10px"}),$("#player6Box").css({left:"560px",top:"80px"}),$("#player7Box").css({left:"560px",top:"150px"}),$("#player8Box").css({left:"560px",top:"220px"}),$("#player9Box").css({left:"560px",top:"290px"})}function setLayoutRound(){$("#player0Box").css({left:"0px",top:"150px"}),$("#player1Box").css({left:"40px",top:"0px"}),$("#player2Box").css({left:"200px",top:"0px"}),$("#player3Box").css({left:"360px",top:"0px"}),$("#player4Box").css({left:"520px",top:"0px"}),$("#player5Box").css({left:"560px",top:"150px"}),$("#player6Box").css({left:"520px",top:"294px"}),$("#player7Box").css({left:"360px",top:"294px"}),$("#player8Box").css({left:"200px",top:"294px"}),$("#player9Box").css({left:"40px",top:"294px"})}function changePlayerName(a){var b=$("#inputPlayer"+a).val();emitUpdatePlayerName(a,b,$("#assistant_id").val())}function deletePlayer(a){$("#inputPlayer"+a).val(""),emitUpdatePlayerName(a,"",$("#assistant_id").val())}function onClickProgression(a){$("a.card_selector.mark").removeClass("active"),$("a.card_selector.rank").removeClass("active"),$("a.card_selector.progression").removeClass("active"),$("a#"+a).addClass("active")}function onClickMark(a){$("a.card_selector.progression").removeClass("active"),$("a.card_selector.mark").removeClass("active"),$("a.card_selector.rank").removeClass("color_s color_h color_d color_c"),$("a#"+a).addClass("active"),$("a.card_selector.rank").addClass("color_"+a)}function onClickRank(a){$("a.card_selector.progression").removeClass("active"),$("a.card_selector.rank").removeClass("active"),$("a#"+a).addClass("active")}function sendImage(a){if(emitImageSendWithPassWord(a,$("#assistant_id").val()),$("#message").html("send "+a),this.mark="",this.rank="ã€€",showBalloon(a),"start"==a)for(var b=0;10>b;b++)$("#inputPlayer"+b).val("")}function onClickSend(){var a=$(".card_selector.progression.active").attr("id");if(a)sendImage(a);else{var b=$(".card_selector.mark.active").attr("id"),c=$(".card_selector.rank.active").attr("id");if(!(b&&c&&(b+"").match(markRegExp)&&(c+"").match(rankRegExp)))return;sendImage(c+b)}$("a.card_selector.mark").removeClass("active"),$("a.card_selector.rank").removeClass("active"),$("a.card_selector.progression").removeClass("active")}function showBalloon(a){var b="send ";b+=2==a.length?a[0]:a,$("#send").showBalloon({contents:b,position:"right",showDuration:100,maxLifetime:3e3,hideDuration:500,classname:"send_balloon",css:{color:"#FFF",backgroundColor:"#4e5d6c",border:"solid 1px #2e3d4c",boxShadow:"2px 2px 2px #999"}}),$(".send_balloon").removeClass("color_s color_h color_d color_c mark_s mark_h mark_d mark_c"),2==a.length&&$(".send_balloon").addClass("send_balloon mark_"+a[1]+" color_"+a[1])}var socket=io.connect("http://"+hostAddress+"/oddsSystem");navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia,window.URL=window.URL||window.webkitURL;var video=document.getElementById("myVideo"),localStream=null;navigator.getUserMedia({video:!0,audio:!1},function(a){video.src=window.URL.createObjectURL(a)},function(a){console.log(a)});var canvasForVideo,background="camera",config={canvasWidth:640,canvasHeight:360};$("#changeBackground").change(function(){background=$(this).val(),$("#canvas_pane").attr("class","wall_"+background)}),setInterval(function(){return config.ctxForVideo&&"camera"===background?void config.ctxForVideo.drawImage(video,0,0,config.canvasWidth,config.canvasHeight):void 0},50),$(function(){canvasForVideo=$("#canvasForVideo").get(0),config.ctxForVideo=canvasForVideo.getContext("2d")});var lastTableInfo={},oddsList=[];addUpdateTableInfoListener(drawTableInfo),addUpdatePasswordListener(setPassword),$(function(){setLayoutRound(),$(".selectpicker").selectpicker({selectedText:"cat"}),$(".selectpicker.btn").addClass("btn-sm"),$(".playerList.0").addClass("stripe_a"),$(".playerList.1").addClass("stripe_b"),$("#show_name").on("click",function(){$(".action_form").hide(),$(".chip_form").hide()}),$("#show_name_action").on("click",function(){$(".action_form").show(),$(".chip_form").hide()}),$("#show_name_action_chip").on("click",function(){$(".action_form").show(),$(".chip_form").show()}),$("#howto_header").on("click",function(){$("#howto_items").collapse("toggle")}),$("#direction_header").on("click",function(){$("#direction_items").collapse("toggle")}),$("#player_header").on("click",function(){$("#player_items").collapse("toggle")}),$("#config_header").on("click",function(){$("#config_items").collapse("toggle")}),$(".draggable").draggable({containment:"#canvas_pane"}),$("#card_selector_toggle").on("click",function(){$("#card_selector").slideToggle()}),$("#assistant_id").on("focusout",function(){var a=$(this).val();a?(emitChangeAssistantMode("Assistant"),emitUpdateAssistantPassword($("#assistant_id").val())):(emitChangeAssistantMode("Original"),emitUpdateAssistantPassword(""))}),$("#title").on("keyup",function(){var a=$("#titleBox");a.text($(this).val()),a.text().length>0?a.show():a.hide()}),$("#blind").on("keyup",function(){var a=$("#blindBox");a.text($(this).val()),a.text().length>0?a.show():a.hide()}),$("#layoutRound").on("click",function(){setLayoutRound()}),$("#layoutSides").on("click",function(){setLayoutSides()}),$("#layoutShow").on("click",function(){$("#titleBox").show(),$("#blindBox").show(),$(".board").show(),$(".playerBox").show()})});var markRegExp=/[shdc]/,rankRegExp=/[2-9TJQKA]/,cards=["As","2s","3s","4s","5s","6s","7s","8s","9s","Ts","Js","Qs","Ks","Ah","2h","3h","4h","5h","6h","7h","8h","9h","Th","Jh","Qh","Kh","Ad","2d","3d","4d","5d","6d","7d","8d","9d","Td","Jd","Qd","Kd","Ac","2c","3c","4c","5c","6c","7c","8c","9c","Tc","Jc","Qc","Kc"],cardsForEasyMode=["Ta","2a","3a","4a","5a","6a","7a","8a","9a","Qa","Wa","Ea","Ra","Ts","2s","3s","4s","5s","6s","7s","8s","9s","Qs","Ws","Es","Rs","Td","2d","3d","4d","5d","6d","7d","8d","9d","Qd","Wd","Ed","Rd","Tf","2f","3f","4f","5f","6f","7f","8f","9f","Qf","Wf","Ef","Rf"];